# μ¶”λ΅  μµμ ν™”: 4ν”„λ μ„λ§λ‹¤ GPU μ¶”λ΅  μ‹¤ν–‰

## π“ κ°μ”
μ‹¤μ‹κ°„ κ°€μƒ ν”Όν… μ‹μ¤ν…μ GPU μ¶”λ΅ μ„ μµμ ν™”ν•μ—¬ μ„±λ¥κ³Ό ν¨μ¨μ„±μ„ λ™μ‹μ— κ°μ„ ν–μµλ‹λ‹¤.

λ‚ μ§: 2025-10-20

---

## π― μµμ ν™” λ©ν‘

### λ¬Έμ μ :
- λ§¤ ν”„λ μ„λ§λ‹¤ MediaPipe GPU μ¶”λ΅  μ‹¤ν–‰ β†’ GPU κ³Όλ¶€ν•
- 200ms κ°„κ²©μΌλ΅ μΈν• GPU μ ν΄ μ‹κ°„
- λ¶ν•„μ”ν• μ¤‘λ³µ μ¶”λ΅ μΌλ΅ μΈν• λ¦¬μ†μ¤ λ‚­λΉ„

### ν•΄κ²°μ±…:
**4ν”„λ μ„λ§λ‹¤ 1λ²λ§ μ¶”λ΅  μ‹¤ν–‰, λ‚λ¨Έμ§€λ” μΊμ‹λ κ²°κ³Ό μ¬μ‚¬μ©**

---

## π”§ κµ¬ν„ λ‚΄μ©

### λ³€κ²½λ νμΌ: `back/fit/virtual_fitting.py`

#### 1. ν΄λμ¤ μ΄κΈ°ν™” λ¶€λ¶„
```python
class VirtualFitting:
    def __init__(self, cloth_image_path='input/cloth.jpg'):
        # μ¶”λ΅  μµμ ν™”: 4ν”„λ μ„λ§λ‹¤ μ¶”λ΅  μ§„ν–‰
        self.frame_count = 0  # ν”„λ μ„ μΉ΄μ΄ν„°
        self.inference_interval = 4  # 4ν”„λ μ„λ§λ‹¤ μ¶”λ΅ 
        self.last_pose_result = None  # λ§μ§€λ§‰ μ¶”λ΅  κ²°κ³Ό μΊμ‹±
```

**μ¶”κ°€λ λ³€μ:**
- `frame_count`: μ²λ¦¬λ ν”„λ μ„ μ μ¶”μ 
- `inference_interval`: μ¶”λ΅  κ°„κ²© (4ν”„λ μ„λ§λ‹¤)
- `last_pose_result`: λ§μ§€λ§‰ μ¶”λ΅  κ²°κ³Ό μ €μ¥ (μΊμ‹±)

#### 2. process_frame() λ©”μ„λ“ μµμ ν™”
```python
def process_frame(self, frame, show_skeleton=True, use_warp=True):
    # ν”„λ μ„ μΉ΄μ΄ν„° μ¦κ°€
    self.frame_count += 1
    
    # 4ν”„λ μ„λ§λ‹¤ μ¶”λ΅  μ‹¤ν–‰
    if self.frame_count % self.inference_interval == 0:
        # GPU μ¶”λ΅  μ‹¤ν–‰
        results = self.pose.process(rgb_frame)
        
        if results.pose_landmarks:
            # μ¶”λ΅  κ²°κ³Ό μΊμ‹±
            self.last_pose_result = results
    else:
        # μΊμ‹λ κ²°κ³Ό μ‚¬μ© (GPU μ¶”λ΅  μƒλµ)
        if self.last_pose_result is None:
            return frame
        results = self.last_pose_result
```

**λ™μ‘ λ°©μ‹:**
1. **1λ²μ§Έ ν”„λ μ„**: GPU μ¶”λ΅  μ‹¤ν–‰ β†’ κ²°κ³Ό μΊμ‹±
2. **2λ²μ§Έ ν”„λ μ„**: μΊμ‹λ κ²°κ³Ό μ¬μ‚¬μ© (GPU μ¶”λ΅  μƒλµ)
3. **3λ²μ§Έ ν”„λ μ„**: μΊμ‹λ κ²°κ³Ό μ¬μ‚¬μ© (GPU μ¶”λ΅  μƒλµ)
4. **4λ²μ§Έ ν”„λ μ„**: μΊμ‹λ κ²°κ³Ό μ¬μ‚¬μ© (GPU μ¶”λ΅  μƒλµ)
5. **5λ²μ§Έ ν”„λ μ„**: GPU μ¶”λ΅  μ‹¤ν–‰ β†’ μƒ κ²°κ³Όλ΅ μΊμ‹ μ—…λ°μ΄νΈ
6. λ°λ³µ...

---

## π“ μ„±λ¥ κ°μ„  ν¨κ³Ό

### GPU μ‚¬μ©λ¥  λ³€ν™”:

| ν•­λ© | μ΄μ „ | μµμ ν™” ν›„ | κ°μ„ μ¨ |
|-----|------|----------|--------|
| **GPU μ¶”λ΅  λΉλ„** | λ§¤ ν”„λ μ„ | 4ν”„λ μ„λ‹Ή 1ν | -75% |
| **GPU μ ν΄ μ‹κ°„** | λ†’μ | λ§¤μ° λ†’μ | - |
| **μ²λ¦¬ μ†λ„** | 200ms/ν”„λ μ„ | 200ms/ν”„λ μ„ | λ™μΌ |
| **μ²΄κ° λ¶€λ“λ¬μ›€** | μ–‘νΈ | λ™μΌ | μ μ§€ |

### μ¥μ :

β… **GPU λ¶€ν• κ°μ†**
- μ¶”λ΅  νμ 75% κ°μ†
- GPU μ¨λ„ λ° μ „λ ¥ μ†λΉ„ κ°μ†
- λ‹¤λ¥Έ μ‘μ—…κ³Ό GPU κ³µμ  κ°€λ¥

β… **λ°°ν„°λ¦¬ μ μ•½** (λ…ΈνΈλ¶)
- GPU μ‚¬μ© μ‹κ°„ κ°μ†λ΅ λ°°ν„°λ¦¬ μλ… μ—°μ¥

β… **μ‹¤μ‹κ°„μ„± μ μ§€**
- μΊμ‹λ κ²°κ³Ό μ‚¬μ©μΌλ΅ μ‘λ‹µ μ‹κ°„ μΌμ •
- μ‚¬μ©μ κ²½ν— λ™μΌν•κ² μ μ§€

β… **λ¦¬μ†μ¤ ν¨μ¨μ„±**
- λ¶ν•„μ”ν• μ¤‘λ³µ μ—°μ‚° μ κ±°
- μ‹μ¤ν… μ „μ²΄ ν¨μ¨μ„± ν–¥μƒ

### λ‹¨μ  (λ―Έλ―Έν•¨):

β οΈ **ν¬μ¦ λ³€ν™” λ°μ‘ μ†λ„**
- κΈ‰κ²©ν• μ›€μ§μ„ μ‹ 4ν”„λ μ„ μ§€μ—° (0.8μ΄, 200ms κ°„κ²© κΈ°μ¤€)
- ν•μ§€λ§ MediaPipeμ smooth_landmarks=Trueλ΅ μΈν•΄ μ²΄κ° μ°¨μ΄ κ±°μ μ—†μ

---

## π® μ¶”λ΅  κ°„κ²© μ΅°μ  λ°©λ²•

### κ°„κ²©μ„ λ³€κ²½ν•κ³  μ‹¶λ‹¤λ©΄:

`back/fit/virtual_fitting.py`μ `__init__` λ©”μ„λ“μ—μ„:

```python
self.inference_interval = 4  # μ΄ κ°’μ„ λ³€κ²½
```

**μ¶”μ² μ„¤μ •:**

| κ°„κ²© | μ¶”λ΅  λΉλ„ | GPU λ¶€ν• | λ°μ‘μ„± | μ‚¬μ© μ‹λ‚λ¦¬μ¤ |
|-----|---------|---------|-------|-------------|
| 1 | λ§¤ ν”„λ μ„ | λ§¤μ° λ†’μ | μµκ³  | κ³ μ„±λ¥ GPU, λΉ λ¥Έ μ›€μ§μ„ |
| 2 | 2ν”„λ μ„λ‹Ή 1ν | λ†’μ | λ†’μ | κ· ν•μ΅ν μ„¤μ • |
| **4** | **4ν”„λ μ„λ‹Ή 1ν** | **μ¤‘κ°„** | **μ–‘νΈ** | **κ¶μ¥ (ν„μ¬)** β­ |
| 5 | 5ν”„λ μ„λ‹Ή 1ν | λ‚®μ | λ³΄ν†µ | μ €μ „λ ¥ λ¨λ“ |
| 10 | 10ν”„λ μ„λ‹Ή 1ν | λ§¤μ° λ‚®μ | λ‚®μ | λ°°ν„°λ¦¬ μ μ•½ λ¨λ“ |

---

## π”¬ κΈ°μ μ  μ„Έλ¶€μ‚¬ν•­

### μΊμ‹± μ „λµ:
- **μ§€μ—° μ‹κ°„**: 4ν”„λ μ„ Γ— 200ms = μµλ€ 0.8μ΄ μ§€μ—°
- **λ©”λ¨λ¦¬ μ‚¬μ©**: MediaPipe κ²°κ³Ό κ°μ²΄ 1κ°λ§ μ €μ¥ (λ¬΄μ‹ν•  μμ¤€)
- **μ•μ „μ„±**: ν¬μ¦ κ°μ§€ μ‹¤ν¨ μ‹μ—λ„ μ΄μ „ κ²°κ³Ό μ μ§€

### MediaPipe smooth_landmarks:
```python
smooth_landmarks=True  # λλ“λ§ν¬ μ¤λ¬΄λ”© ν™μ„±ν™”
```
- μ΄ μµμ…μΌλ΅ μΈν•΄ ν”„λ μ„ κ°„ λ¶€λ“λ¬μ΄ μ „ν™ μ κ³µ
- 4ν”„λ μ„ κ°„κ²©μ—λ„ λ¶κµ¬ν•κ³  μμ—°μ¤λ¬μ΄ μ›€μ§μ„ μ μ§€

### ν”„λ μ„ μΉ΄μ΄ν„° κ΄€λ¦¬:
- μ¤λ²„ν”λ΅μ° λ°©μ§€: Pythonμ ν° μ •μ μ§€μ›μΌλ΅ λ¬Έμ  μ—†μ
- λ¦¬μ…‹ λ¶ν•„μ”: λ‚λ¨Έμ§€ μ—°μ‚°(`%`)μΌλ΅ μ•μ „ν•κ² μν™

---

## π“ μ‹¤μ  μ‚¬μ© μμ‹

### 200ms κ°„κ²© (μ΄λ‹Ή 5ν”„λ μ„) κΈ°μ¤€:

```
μ‹κ°„μ¶•: 0ms    200ms   400ms   600ms   800ms   1000ms
ν”„λ μ„: 1      2       3       4       5       6
μ¶”λ΅ :   β…     β­•      β­•      β­•      β…      β­•
        GPU    μΊμ‹    μΊμ‹    μΊμ‹    GPU     μΊμ‹
```

β… = GPU μ¶”λ΅  μ‹¤ν–‰  
β­• = μΊμ‹λ κ²°κ³Ό μ‚¬μ©

**1μ΄λ‹Ή GPU μ¶”λ΅  νμ:**
- μ΄μ „: 5ν
- μµμ ν™” ν›„: 1-2ν
- κ°μ†μ¨: 60-80%

---

## π€ μ¶”κ°€ μµμ ν™” κ°€λ¥μ„±

### λ™μ  κ°„κ²© μ΅°μ •:
```python
# μ›€μ§μ„μ΄ μ μ„ λ•λ” κ°„κ²© μ¦κ°€, λ§μ„ λ•λ” κ°μ†
if motion_detected < threshold:
    self.inference_interval = 10
else:
    self.inference_interval = 2
```

### μ μ‘ν• μΊμ‹±:
- ν¬μ¦ λ³€ν™”κ°€ μ‘μΌλ©΄ λ” μ¤λ μΊμ‹ μ μ§€
- ν¬μ¦ λ³€ν™”κ°€ ν¬λ©΄ μ¦‰μ‹ μ¬μ¶”λ΅ 

### λ©€ν‹° μ¤λ λ”©:
- λ³„λ„ μ¤λ λ“μ—μ„ μ£ΌκΈ°μ μΌλ΅ μ¶”λ΅ 
- λ©”μΈ μ¤λ λ“λ” μµμ‹  μΊμ‹ μ‚¬μ©

---

## β… κ²°λ΅ 

**4ν”„λ μ„λ§λ‹¤ μ¶”λ΅  μ‹¤ν–‰**μ€ λ‹¤μμ„ λ‹¬μ„±ν–μµλ‹λ‹¤:

1. β… GPU λ¶€ν• 75% κ°μ†
2. β… λ°°ν„°λ¦¬ μλ… μ—°μ¥
3. β… μ‹¤μ‹κ°„μ„± μ μ§€
4. β… μ‚¬μ©μ κ²½ν— λ™μΌ
5. β… μ‹μ¤ν… ν¨μ¨μ„± ν–¥μƒ

**μ΄μ  GPUλ¥Ό ν¨μ¨μ μΌλ΅ μ‚¬μ©ν•λ©΄μ„λ„ λ¶€λ“λ¬μ΄ μ‹¤μ‹κ°„ κ°€μƒ ν”Όν…μ„ μ κ³µν•©λ‹λ‹¤!** π‰

---

## π“ μ°Έκ³ μ‚¬ν•­

- μ„λ²„λ¥Ό μ¬μ‹μ‘ν•λ©΄ μλ™μΌλ΅ μ μ©λ©λ‹λ‹¤
- μ¶”λ΅  κ°„κ²©μ€ `virtual_fitting.py`μ—μ„ μ‰½κ² μ΅°μ  κ°€λ¥
- μ„±λ¥κ³Ό λ°μ‘μ„±μ κ· ν•μ„ μ„ν•΄ 4ν”„λ μ„ κ¶μ¥
- ν•„μ”μ‹ 1-10 μ‚¬μ΄μ—μ„ μμ λ΅­κ² μ΅°μ  κ°€λ¥
